import{O as e,d as t,_ as l,h as a,o as i,b as n,G as s,w as r,m as u,a as o,c as d,r as p,B as c,t as f,A as m,F as y,n as h}from"./main-chunk-fdacad84.js";import{I as g}from"./InputTemplate-chunk-df175f93.js";function v(t){return e.some((e=>t.includes(e)))}const b=t({name:"InputFile",components:{InputTemplate:g},mixins:[{computed:{getFileData:()=>e=>{if("string"==typeof e){const{fileName:t,fileExtension:l}=function(e){const t=e.match(/([^/]+)\.([^/]+)$/i);if(t){const e=t[1],l=t[2];return{fileName:`${e}.${l}`,fileExtension:l,fileNameWithoutExtension:e}}return{fileName:"",fileExtension:"",fileNameWithoutExtension:""}}(e);return{name:t,ext:l,url:e,type:"url",isImage:v(l)}}const{name:t,type:l}=e;return console.log(e),{name:t,ext:t.split(".").pop()||"",url:v(l)?URL.createObjectURL(e):"",type:"file",isImage:v(l)}}}}],props:{modelValue:{type:[Array,FileList],default:()=>null},accept:{type:String,default:()=>"image/*"},id:{type:String,default:()=>""},multiple:{type:Boolean,default:!1},label:{type:String,default:()=>""},placeholder:{type:String,default:()=>"Прикрепить фото"},readOnly:{type:Boolean,default:()=>!1},disabled:{type:Boolean,default:()=>!1},required:{type:Boolean,default:()=>!1},name:{type:String,default:()=>""},title:{type:String,default:()=>""},errors:{type:Array,default:()=>[]}},emits:["update:modelValue"],computed:{value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},valueWithData(){return this.value?this.value instanceof FileList?Array.from(this.value).map((e=>({...this.getFileData(e)}))):this.value.map((e=>({...this.getFileData(e)}))):[]}},methods:{changeHandler(e){const t=e.target,l=t.files?Array.from(t.files):[];if(0===l.length)return;const a=new DataTransfer;l.forEach((e=>a.items.add(e))),this.value=a.files,t.value=""},deleteFile(e){if("url"===e.type)return void(this.value=this.value.filter((t=>t!==e.url)));const{name:t}=e,l=Array.from(this.value).filter((e=>e.name!==t)),a=new DataTransfer;l.forEach((e=>a.items.add(e))),this.value=a.files},simulateClick(){this.$refs.inputFile&&this.$refs.inputFile.click()}}}),_=["id","multiple","disabled","required","title","accept","name"],k={class:"input-file__placeholder"},x={class:"files-preview"},w=["title"],F=["src","alt"],$={key:1,class:"file-preview__ext"},I=["onClick","onKeydown"],D=[o("span",{class:"file-preview__del-icon"},null,-1)];const E=l(b,[["render",function(e,t,l,g,v,b){const E=a("InputTemplate");return i(),n(E,{id:e.id,label:e.label,tag:"span",errors:e.errors},s({underInput:r((()=>[o("div",x,[(i(!0),d(y,null,p(e.valueWithData,(t=>(i(),d("div",{key:t.name,title:t.name,class:"files-preview__item file-preview"},[t.isImage?(i(),d("img",{key:0,class:"file-preview__img",src:t.url,alt:t.name},null,8,F)):c("",!0),t.ext?(i(),d("span",$,"."+f(t.ext),1)):c("",!0),e.readOnly?c("",!0):(i(),d("span",{key:2,"aria-hidden":"true",tabindex:"0",role:"button",class:"file-preview__del",onClick:l=>e.deleteFile(t),onKeydown:m((l=>e.deleteFile(t)),["enter"])},D,40,I))],8,w)))),128))])])),default:r((()=>[o("label",{tabindex:"0",class:h(["input-file",[{error:e.errors.length},{disabled:e.disabled},{readonly:e.readOnly}]]),onKeydown:t[1]||(t[1]=m(((...t)=>e.simulateClick&&e.simulateClick(...t)),["enter"]))},[o("input",{id:e.id,ref:"inputFile",multiple:e.multiple,disabled:e.disabled||e.readOnly,required:e.required,title:e.title,accept:e.accept,name:e.name,type:"file",class:"input-file__input",onChange:t[0]||(t[0]=(...t)=>e.changeHandler&&e.changeHandler(...t))},null,40,_),o("span",k,f(e.placeholder),1)],34)])),_:2},[e.$slots.label?{name:"label",fn:r((({labelValue:t})=>[u(e.$slots,"label",{labelValue:t})])),key:"0"}:void 0,e.$slots.action?{name:"action",fn:r((()=>[u(e.$slots,"action")])),key:"1"}:void 0]),1032,["id","label","errors"])}]]);export{E as default};
