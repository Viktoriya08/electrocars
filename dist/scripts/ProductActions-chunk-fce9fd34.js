import{d as e,Y as o,E as a,_ as t,h as s,k as l,o as r,c as d,a as n,i,e as c,w as m,l as u,v as p,t as f,z as _,Z as h,b,r as k,F as v,y as I,$ as D,B as y}from"./main-chunk-fdacad84.js";import C from"./BaseModal-chunk-2b62698c.js";import{I as g}from"./IconSVG-chunk-cd8e7ea2.js";import M from"./InputText-chunk-675f41fd.js";import x from"./FadeTransition-chunk-e258e4e0.js";import{c as V}from"./closeTimer-chunk-812bc3f8.js";import{u as T,r as $,m as j,c as F}from"./index-chunk-b278f882.js";import w from"./BaseTooltip-chunk-f6afb20c.js";import B from"./InputCheckbox-chunk-5f448c83.js";import"./checkDialogSupport-chunk-14ab1891.js";import"./InputTemplate-chunk-df175f93.js";import"./getMask-chunk-73dd093f.js";const S=e({name:"OrderForm",components:{FadeTransition:x,InputText:M},mixins:[V],props:{agreement:{type:String,default:()=>"#"},carId:{type:Number,required:!0,default:null}},setup(){const e=o({}),{withMessage:t}=F,s=a("viewportUntil"),l=a("modalId");return{viewportUntil:s,withMessage:t,externalResults:e,v$:T({$externalResults:e}),modalId:l}},data:()=>({isFinished:!1,formData:{name:"",phone:""}}),validations(){return{formData:{name:{required:this.withMessage("Поле обязательно для заполнения",$)},phone:{required:this.withMessage("Поле обязательно для заполнения",$),minLength:this.withMessage("Некорректный номер телефона",j(18))}}}},methods:{sendForm(){this.v$.$validate().then((e=>{e&&(this.isFinished=!0,this.startCloseTimer(this.modalId))})).catch((e=>{console.log(e)}))}}}),U={class:"form__items"},q={class:"form__item"},G={class:"form__item"},O={class:"form__bottom"},A={class:"form__submit"},z=["disabled"],E={class:"form__policy"},N=["href"],R={class:"form__final"},L={class:"form__title"},P=n("br",null,null,-1),Y=n("br",null,null,-1),Z={class:"form__close"},H=n("span",{class:"form__close-text"},"Окно автоматически закроется через",-1),J={class:"form__close-time"};const K=e({name:"OrderModal",components:{OrderForm:t(S,[["render",function(e,o,a,t,h,b){const k=s("InputText"),v=s("FadeTransition"),I=l("animate");return r(),d("form",{class:"form",onSubmit:o[2]||(o[2]=_(((...o)=>e.sendForm&&e.sendForm(...o)),["prevent"]))},[n("div",U,[n("div",q,[i(k,{id:"name-callback",modelValue:e.formData.name,"onUpdate:modelValue":o[0]||(o[0]=o=>e.formData.name=o),errors:e.v$.formData.name.$errors,label:"Как вас зовут?",autocomplete:"given-name",placeholder:"Укажите имя"},null,8,["modelValue","errors"])]),n("div",G,[i(k,{id:"phone-callback",modelValue:e.formData.phone,"onUpdate:modelValue":o[1]||(o[1]=o=>e.formData.phone=o),errors:e.v$.formData.phone.$errors,label:"Укажите телефон",placeholder:"+7 999 999-99-99",type:"tel",autocomplete:"tel","mask-type":"phoneMask","required-text":"Обязательное поле"},null,8,["modelValue","errors"])])]),n("div",O,[n("div",A,[n("button",{class:"btn btn--color-primary",type:"submit",disabled:e.v$.$error&&e.v$.$dirty}," Отправить заявку ",8,z)]),n("p",E,[c(" Отправляя данные, вы соглашаетесь с "),n("a",{href:e.agreement,target:"_blank"},"политикой конфиденциальности",8,N)])]),i(v,null,{default:m((()=>[u(n("div",R,[u((r(),d("h3",L,[c(" Заявка отправлена! "),P,c(" Мы свяжемся с вами "),Y,c(" в ближайшее время. ")])),[[I,{animationClass:"fadeInUp"}]]),n("div",Z,[H,n("span",J,f(e.getCloseTimer),1)])],512),[[p,e.isFinished]])])),_:1})],32)}]]),IconSVG:g,BaseModal:C},props:{modalId:{type:String,required:!0,default:""},carId:{type:Number,required:!0,default:null}},setup:e=>(h("modalId",e.modalId),{})}),Q={class:"modal"},W=["onClick"],X={class:"modal__wrapper"},ee=n("div",{class:"modal__top"},[n("h3",{class:"modal__title"}," Отправьте заявку на покупку электромобиля. Мы свяжемся с вами в ближайшее время. ")],-1);const oe=t(K,[["render",function(e,o,a,t,l,d){const c=s("IconSVG"),u=s("OrderForm"),p=s("BaseModal");return r(),b(p,{id:e.modalId},{default:m((({close:o})=>[n("section",Q,[n("button",{class:"modal__close",onClick:o},[i(c,{class:"modal__close-icon",name:"close"})],8,W),n("div",X,[ee,i(u,{"car-id":e.carId,class:"modal__form"},null,8,["car-id"])])])])),_:1},8,["id"])}]]),ae=e({name:"AddCompareModal",components:{BaseTooltip:w,InputCheckbox:B,IconSVG:g,BaseModal:C},props:{modalId:{type:String,required:!0,default:""},offers:{type:Array,required:!0,default:()=>[]}},data:()=>({formData:{selectedItems:[]}}),computed:{isChecked(){return e=>this.formData.selectedItems.includes(e)},isDisabled(){return e=>this.formData.selectedItems.length>=3&&!this.isChecked(e)}},methods:{setValue(e,o){e?this.formData.selectedItems.push(o):this.formData.selectedItems=this.formData.selectedItems.filter((e=>e!==o))}}}),te={class:"modal"},se=["onClick"],le={class:"modal__wrapper"},re=n("div",{class:"modal__top"},[n("h3",{class:"modal__title"},[c(" Выберите комплектацию"),n("br"),c(" для сравнения ")])],-1),de={class:"modal__form form"},ne={class:"form__items"},ie=n("span",null,"Добавлено максимальное кол-во электрокаров для сравнения",-1),ce=n("div",{class:"form__bottom"},[n("div",{class:"form__submit"},[n("button",{class:"btn btn--color-primary",type:"submit"}," Выбрать ")])],-1);const me=e({name:"ProductActions",components:{AddCompareModal:t(ae,[["render",function(e,o,a,t,l,c){const u=s("IconSVG"),p=s("InputCheckbox"),f=s("BaseTooltip"),_=s("BaseModal");return r(),b(_,{id:e.modalId},{default:m((({close:o})=>[n("section",te,[n("button",{class:"modal__close",onClick:o},[i(u,{class:"modal__close-icon",name:"close"})],8,se),n("div",le,[re,n("form",de,[n("div",ne,[(r(!0),d(v,null,k(e.offers,(o=>(r(),d("div",{key:o.id,class:"form__item form__item--checkbox"},[e.isDisabled(o.id)?(r(),b(f,{key:0,placement:"bottom"},{tooltip:m((()=>[ie])),default:m((()=>[i(p,{id:`offer-${o.id}`,"model-value":e.isChecked(o.id),text:o.name,disabled:!0,"onUpdate:modelValue":a=>e.setValue(a,o.id)},null,8,["id","model-value","text","onUpdate:modelValue"])])),_:2},1024)):(r(),b(p,{key:1,id:`offer-${o.id}`,"model-value":e.isChecked(o.id),text:o.name,disabled:e.isDisabled(o.id),"onUpdate:modelValue":a=>e.setValue(a,o.id)},null,8,["id","model-value","text","disabled","onUpdate:modelValue"]))])))),128))]),ce])])])])),_:1},8,["id"])}]]),BaseTooltip:w,OrderModal:oe,IconSVG:g},mixins:[I,D],props:{productData:{type:Object,default:()=>({id:Math.round(1e3*Math.random()),name:""})}},methods:{addToCompare(){this.showCustomMessage("Электрокар добавлен\nк сравнению",{icon:{iconClass:"toast__icon toast__icon--compare",iconTag:"span"}})}}}),ue={class:"product-card__actions"},pe={class:"icon-btn icon-btn--color-secondary"},fe=n("span",null,"Добавлено максимальное кол-во электрокаров для сравнения",-1),_e=[n("span",{class:"btn__text"},"Отправить заявку",-1)];const he=t(me,[["render",function(e,o,a,t,l,c){const u=s("IconSVG"),p=s("BaseTooltip"),f=s("OrderModal"),_=s("AddCompareModal");return r(),d("div",ue,[e.productData.offers&&e.productData.offers.length?(r(),d("button",{key:0,class:"icon-btn icon-btn--color-secondary product-card__action",onClick:o[0]||(o[0]=o=>e.openModal(`compare-modal-${e.productData.id}`))},[i(u,{class:"icon-btn__icon",name:"compare"})])):e.productData.offers&&!e.productData.offers.length?(r(),b(p,{key:1,class:"product-card__action","show-on-click":"",placement:"bottom"},{tooltip:m((()=>[fe])),default:m((()=>[n("button",pe,[i(u,{class:"icon-btn__icon",name:"compare"})])])),_:1})):(r(),d("button",{key:2,class:"icon-btn icon-btn--color-secondary product-card__action",onClick:o[1]||(o[1]=(...o)=>e.addToCompare&&e.addToCompare(...o))},[i(u,{class:"icon-btn__icon",name:"compare"})])),n("button",{class:"product-card__action btn btn--size-medium btn--color-primary",onClick:o[2]||(o[2]=o=>e.openModal(`order-modal-${e.productData.id}`))},_e),i(f,{"modal-id":`order-modal-${e.productData.id}`,"car-id":e.productData.id},null,8,["modal-id","car-id"]),e.productData.offers&&e.productData.offers.length?(r(),b(_,{key:3,offers:e.productData.offers,"modal-id":`compare-modal-${e.productData.id}`},null,8,["offers","modal-id"])):y("",!0)])}]]);export{he as default};
